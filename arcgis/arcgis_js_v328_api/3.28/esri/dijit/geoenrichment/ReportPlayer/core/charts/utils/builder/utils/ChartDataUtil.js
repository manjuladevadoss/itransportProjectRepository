// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.28/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/charts/utils/builder/utils/ChartDataUtil",["../../../../supportClasses/templateJsonUtils/fieldInfo/FieldInfoRenderer","esri/dijit/geoenrichment/utils/ObjectUtil","../../ChartTypes"],function(l,p,h){var f={formatNumber:function(a,b,c){a=p.formatNumber(a||0,{places:b.dataLabelsDecimals||0,preserveTrailingZeroes:!0});c&&(a+="%");return a},undefinedToDefault:function(a,b){return void 0===a?b:a}},k=[1E3,1100,1200,150,70,900,110,300,80,200,1700],q=[1E3,
-300,700,-150,70,100,-200,900,110,300,80,200,1700],r=[1,.7,1.2,.5,1.1,1.3,.3,2,.4],t=[.91,.92,.9,1.2,1.2,1.3];f.CHART_DATA_SMOOTH=[1145,1134,1159,1275,1404,1408,1337,1149,1074,1040,1065,1078,964,798,531,360,254,258];f.getPointValue=function(a){var b=a.point,c=a.index,f=a.seriesIndex,g=a.chartType,e=a.visualProperties,m=a.viewModel,n=a.currentFeatureIndex,d=a.chartData,v=a.isComparisonSeries,u=a.comparisonFeatureAttribute,w=a.allowNegativeValuesInPreview;a=a.numPoints;if(b.value&&(b.value.value||m.dynamicReportInfo))return b.value.value;
m.dynamicReportInfo?(d=v?u&&u[b.fieldInfo.name]||0:l.getFieldDataValue(b.fieldInfo,m.dynamicReportInfo.fieldData,n),d=p.parseNumber(d),isNaN(d)&&console.log("Can't render chart value for field \x3d\x3e "+(b.fieldInfo?b.fieldInfo.name:"missing field"))):(b=b.fieldInfo&&b.fieldInfo.statefulName&&b.fieldInfo.statefulName.charAt(0),g===h.GAUGE&&"p"!==b&&e.gaugeRangeMax?(c=e.gaugeRangeMin||0,d=.425123*(e.gaugeRangeMax-c)+c):g===h.WAFFLE&&"p"!==b&&e.waffleRangeMax?(c=e.waffleRangeMin||0,d=.9085*(e.waffleRangeMax-
c)+c):(d=d||(w?q:k),d=d[c%d.length],d*=r[f%r.length]*(0===f?1:t[c%t.length]),e.conditionalStyling||(c=d,e=e.dataLabelsDecimals,"p"===b&&(c=Number((c/24.5123).toFixed(e||1))),"i"===b&&(c=Number((c/7).toFixed(e||1))),d=c)),g===h.WAFFLE&&a&&(d="p"===b?90.85/a:d/a));return d};f.getCaptionValue=function(a,b){return a.captionFieldInfo?b.dynamicReportInfo?l.getFieldDataValue(a.captionFieldInfo,b.dynamicReportInfo.fieldData):l.renderFieldInfoInTableCell(a.captionFieldInfo).formattedValue:""};f.allowNegativeValuesInPreview=
function(a,b){return h.supportsNegativeValues(a)&&!b.isStacked&&!b.renderColumnBarsInOppositeDirections};f.getChartData=function(a,b,c,f){c=(c||(f?q:k)).slice();c.length=Math.min(c.length,b);var g=-Infinity;c.forEach(function(a){g=Math.max(g,a)});var e=1.1*a.max/g;return c=c.map(function(a){return a*e})};var n=k;f.setPreviewChartData=function(a){k=a||n};return f});