// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.28/esri/copyright.txt for details.
//>>built
require({cache:{"url:esri/dijit/RasterFunctionEditor/templates/RFxAttributeTable.html":'\x3cdiv class\x3d"esriRFxAttributeTable"\x3e\r\n    \x3ctable class\x3d"esriRFxAttributeTable__table"\x3e\r\n      \x3ctr class\x3d"esri-rfx-args-editor__tr--arg-name"\x3e\r\n          \x3ctd data-dojo-attach-point\x3d"rasterLabel"\x3e\x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr class\x3d"esri-rfx-args-editor__tr--arg-widget"\x3e\r\n        \x3ctd\x3e\r\n            \x3cdiv data-dojo-type\x3d"esri/dijit/RasterFunctionEditor/RFxRasterInput" data-dojo-attach-point\x3d"_layerSelect" data-dojo-props\x3d"inputLayers: this.inputLayers, allowScalar: this.allowScalar"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr class\x3d"esriRFxArgsEditor__tr--arg-name"\x3e\r\n        \x3ctd data-dojo-attach-point\x3d"tableTypeLabel"\x3e${_i18n.tableType}\x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr class\x3d"esriRFxArgsEditor__tr--arg-widget"\x3e\r\n        \x3ctd colspan\x3d"2"\x3e\r\n          \x3cdiv data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"tableTypeSelect"\x3e\r\n            \x3cspan value\x3d"manual"\x3e${_i18n.manual}\x3c/span\x3e\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/table\x3e\r\n  \r\n    \x3cdiv data-dojo-attach-point\x3d"attributeTable"\x3e\x3c/div\x3e\r\n    \r\n    \x3cdiv class\x3d"esriGenerateTableOptions" data-dojo-attach-point\x3d"generateOptions" data-dojo-type\x3d"dijit/TitlePane" data-dojo-props\x3d"title: \'${_i18n.generateTable}\', open: false"\x3e\r\n      \x3ctable\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd\x3e\r\n            ${_i18n.minVal}\r\n          \x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"minValSelect"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd\x3e\r\n            ${_i18n.maxVal}\r\n          \x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"maxValSelect"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd\x3e\r\n            ${_i18n.baseClassName}\r\n          \x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3cdiv data-dojo-type\x3d"dijit/form/TextBox" data-dojo-attach-point\x3d"baseClassNameInput" value\x3d"${_i18n.defaultClassName}"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd\x3e\r\n            ${_i18n.colorScheme}\r\n          \x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"colorRampNode"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/table\x3e\r\n      \x3cbutton class\x3d"esriAttributeTableGenerateTable" data-dojo-attach-point\x3d"generateButton" data-dojo-type\x3d"dijit/form/Button" type\x3d"button"\x3e${_i18n.generateTable}\x3c/button\x3e\r\n    \x3c/div\x3e\r\n   \r\n  \x3c/div\x3e\r\n  '}});
define("esri/dijit/RasterFunctionEditor/RFxAttributeTable","dojo/_base/declare dojo/_base/lang dojo/has dojo/i18n!../../nls/jsapi dojo/text!./templates/RFxAttributeTable.html dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/form/NumberSpinner ./EditableGridMixin ./RFxGridBase ../ColorRampSelector ../../renderers/colorRampUtils ../../kernel".split(" "),function(c,d,h,k,l,m,n,p,q,r,f,t,u,v){c=c([m,n,p,r],{templateString:l,baseClass:"esriRFxAttributeTable",nCols:0,dataTypes:[f.DATA_TYPES.string,
f.DATA_TYPES.string,"color"],fieldNames:["Value","ClassName","Color"],_store:null,_grid:null,defaults:{min:1,max:7},fields:[{name:"ObjectID",type:"esriFieldTypeOID",alias:"OID"},{name:"Value",type:"esriFieldTypeInteger",alias:"Value"},{name:"ClassName",type:"esriFieldTypeString",alias:"ClassName",length:256},{name:"Red",type:"esriFieldTypeInteger",alias:"Red"},{name:"Green",type:"esriFieldTypeInteger",alias:"Green"},{name:"Blue",type:"esriFieldTypeInteger",alias:"Blue"},{name:"Alpha",type:"esriFieldTypeInteger",
alias:"Alpha"}],constructor:function(a){this.inherited(arguments);this._i18n=k.widgets.rasterFunctionEditor.rfxAttributeTable},postCreate:function(){this.inherited(arguments);this._validateInputArgs();this._setLabels();this._setupLayerSelect();this._setupValueControls();this._setupColorRamp();this._initializeGrid();this.generateButton.on("click",d.hitch(this,this._onGenerateTableClick));this._grid.on("grid-data-change",d.hitch(this,this._updateValue))},_validateInputArgs:function(){if(!Object.keys(this.inputArgs).some(function(a){if("AttributeTableAsRecordSet"===
a)return!0})){var a={name:"AttributeTableAsRecordSet",isPublic:!1,type:"RecordSet"};this.rfxArgs.AttributeTableAsRecordSet=a;this.inputArgs.AttributeTableAsRecordSet=a}},_setupLayerSelect:function(){this.rasterArg=this.inputArgs&&this.inputArgs.Raster;this._layerSelect.set("inputLayers",this.inputLayers);this._layerSelect.set("allowScalar",this.allowScalar);this._layerSelect.set("rfxVariable",this.rasterArg);this.own(this._layerSelect.on("change",this._updateRasterInputArg.bind(this)))},_updateRasterInputArg:function(){this.rasterArg.value=
this._layerSelect.get("value")},_setupValueControls:function(){this.minVal=this._createValueControl(this.minValSelect,this.defaults.min);this.maxVal=this._createValueControl(this.maxValSelect,this.defaults.max)},_setupColorRamp:function(){this.colorRampSelect=new t({maxHeight:200,includeDefault:!1},this.colorRampNode);this.colorRampSelect.startup();this.colorRampSelect.setSelected("Aspect")},_createValueControl:function(a,b){a=new q({value:b,smallDelta:1,constraints:{min:-127,max:127,places:0}},a);
a.startup();return a},_initializeGrid:function(){var a=this._getGridSchema(),b=this._createDataObject();this._grid=new f({schema:a,data:b,hasIdColumn:!0,defaultBlankObject:this._getDefaultValueObject()},this.attributeTable)},_getGridSchema:function(){var a=[];return a=this.fieldNames.map(function(a,g){return{label:this._i18n[a.toLowerCase()],name:a,dataType:this.dataTypes[g]}},this)},_createDataObject:function(){var a=[];(this.recordSetArg=this.inputArgs&&this.inputArgs.AttributeTableAsRecordSet)&&
this.recordSetArg.features&&this.recordSetArg.features.length&&this.recordSetArg.features.forEach(function(b){b=b.attributes;a.push({Value:b.Value,ClassName:b.ClassName,colorObject:{r:b.Red,g:b.Green,b:b.Blue,a:b.Alpha,id:b.ObjectID}})});return a},_getDefaultValueObject:function(){return{Value:0,ClassName:"",colorObject:{r:0,g:0,b:0,a:1}}},_onGenerateTableClick:function(){var a=this._getGridData();this._grid.updateStoreValue(a);this._updateValue(a)},_getGridData:function(){for(var a=this.minVal.value,
b=this.maxVal.value,g=this.baseClassNameInput.value,c=[],d=u.convertColorRampToColormap(this.colorRampSelect.colorRamp,b-a+1),e=0;a<=b;a++)c.push({Value:a,ClassName:g+a,colorObject:{r:d[e][1],g:d[e][2],b:d[e][3],a:1,id:e}}),e++;return c},_updateValue:function(a){var b=[];a.forEach(function(a,c){a&&"*"!==a.idNum&&(a={attributes:{ObjectID:c,Value:parseInt(a.Value,10),ClassName:a.ClassName,Red:a.colorObject.r,Green:a.colorObject.g,Blue:a.colorObject.b,Alpha:a.colorObject.a}},b.push(a))});this.recordSetArg.fields||
(this.recordSetArg.fields=this.fields);this.recordSetArg.features=b},_setLabels:function(){this.inputArgs&&this.inputArgs.Raster&&(this.rasterLabel.innerHTML=this.inputArgs.Raster.displayName||this.inputArgs.Raster.name)}});h("extend-esri")&&d.setObject("dijit.RasterFunctionEditor.RFxAttributeTable",c,v);return c});