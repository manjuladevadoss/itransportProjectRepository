// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.28/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/InfographicsConfig","esri/declare dojo/_base/lang ./_Wizard ./InfographicsOptions ./InfographicsMainPage ./DataBrowser ./utils/lang dojo/i18n!esri/nls/jsapi".split(" "),function(p,c,q,k,r,t,u,v){return p("esri.dijit.geoenrichment.InfographicsConfig",[q],{options:null,startup:function(){this._started||(this.inherited(arguments),this.pages.m=new r({onAddVariables:c.hitch(this,this._addVariables),onOK:c.hitch(this,this._onOK),onCancel:c.hitch(this,this._onCancel)}),this.options||
this.set("options",new k),this.loadPage("m"))},_setOptionsAttr:function(b){this._set("options",b);this.pages.m.set("options",b)},_getCountryIDAttr:function(){return this.pages.m.get("countryID")},_setCountryIDAttr:function(b){this.pages.m.set("countryID",b)},_addVariables:function(){var b=this,e=this.get("countryID"),a=this.pages.db;a?a.set("countryID",e):(a=new t({countryID:e,countryBox:!1,title:this.pages.m.nls.mainTitle}),a.on("back",c.hitch(this,this.loadPage,"m")),a.on("cancel",c.hitch(this,
this._onCancel)),a.on("ok",c.hitch(this,this._applyVariables)),this.pages.db=a);var l=[];this.options.getItems(e).then(function(g){for(var e=0;e<g.length;e++){var f=g[e];"OneVar"==f.type&&1==f.variables.length&&l.push(f.variables[0])}a.set("selection",l);b.loadPage("db");a.launch()})},_applyVariables:function(){function b(e){for(var a=0;a<c.length;a++);return null[e]}for(var e=this,a=this.pages.m.get("countryID"),c=this.pages.db.variables.dataCollections.data,g={},m=this.pages.db.get("selection"),
f=0;f<m.length;f++){var d=m[f];if(u.endsWith(d,".*"))for(var d=d.split(".")[0],d=b(d).variables,h=0;h<d.length;h++)g[d[h].fullName]=!0;else g[d]=!0}var n=this.pages.db.variables;this.options.getItems(a).then(function(a){var c,b;for(c=a.length-1;0<=c;c--)if(b=a[c],"OneVar"==b.type&&1==b.variables.length){var d=n.get(b.variables[0]);d&&g[d.fullName]?delete g[d.fullName]:a.splice(c,1)}for(var f in g)d=n.get(f),b=new k.Item("OneVar",[f]),b.title=d.alias,a.push(b);e.loadPage("m");e.pages.m.set("options",
e.options)})},_onOK:function(){this.emit("ok")},_onCancel:function(){this.emit("cancel")}})});