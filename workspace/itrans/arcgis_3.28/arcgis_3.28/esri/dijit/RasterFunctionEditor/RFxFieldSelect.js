// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.28/esri/copyright.txt for details.
//>>built
define("esri/dijit/RasterFunctionEditor/RFxFieldSelect","dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojo/store/Memory dojo/data/ObjectStore dojo/i18n!../../nls/jsapi dijit/form/Select ../../kernel".split(" "),function(d,c,e,k,f,g,l,m,n){d=d([m],{declaredClass:"esri.dijit.RasterFunctionEditor.RFxFieldSelect",postCreate:function(){this.inherited(arguments);this._i18n=l.widgets.rasterFunctionEditor.rfxFieldSelect},startup:function(){this.inherited(arguments);this.setFieldOptions(this.layerArg)},
setFieldOptions:function(){if(this.layerArg&&this.layerArg.input){var a=this.layerArg.input,b;this.set("labelAttr","alias");if(0<a.declaredClass.indexOf("RFxFeatureSelect")&&a.value)e.some(a.inputLayers,function(h){if(h.url===a.value.url)return b=h,!0}),b&&this.setStore(new g(new f({idProperty:"name",data:c.clone(b.fields)})));else if(0<a.declaredClass.indexOf("RFxRasterInput")&&a.value)if(b=a.getSelectedLayer(a.get("value").name))if(b.loaded)b.hasRasterAttributeTable?this.setFieldStore(b):this.set("store",
this._getFieldStore());else b.on("load",c.hitch(this,function(a){this.setFieldStore(a.target)}));else this.set("store",this._getFieldStore());this.reset()}},setFieldStore:function(a){a.getRasterAttributeTable({renderingRule:a.renderingRule}).then(c.hitch(this,function(a){a&&a.fields?this.set("store",this._getFieldStore(a.fields)):this.set("store",this._getFieldStore());this.selectedValue?this.set("value",this.selectedValue):this.reset()}),c.hitch(this,function(a){this.set("store",this._getFieldStore());
this.reset()}))},_getFieldStore:function(a){var b=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString"];return a&&a.length?(a=e.filter(a,function(a){return-1<e.indexOf(b,a.type)}),new g(new f({data:a,idProperty:"name"}))):new g(new f({data:[{name:"VALUE",alias:this._i18n.value},{name:"COUNT",alias:this._i18n.count}],idProperty:"name"}))}});k("extend-esri")&&c.setObject("dijit.RasterFunctionEditor.RFxFieldSelect",d,n);return d});