// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.28/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/charts/utils/builder/round/_RoundChartSeriesCalculator","../../ThemeCalculator ../../ChartTypes ../../ChartSorting ../../../../supportClasses/conditionalStyling/ConditionalStyleUtil ../utils/ChartDataUtil ../utils/TooltipInfoBuilder dojo/i18n!esri/nls/jsapi".split(" "),function(C,h,u,v,w,D,I){return{calcSeries:function(a){var x=a.seriesItems,e=a.chartType,E=a.themeSettings,F=a.viewModel,c=a.visualProperties,G=a.currentFeatureIndex,k=a.sorting;a=[];
var g=x[0],l={name:"data",data:[]};a.push(l);if(!g||!g.points.length)return a;var y=[],m=0,n=0,p=1E6,q=-1E6,z,r=g.points;if(h.isConditionalStylingEnabled(e)&&c.conditionalStyling){var A=v.getStatistics(c.conditionalStyling);A&&g&&(z=w.getChartData(A,r.length))}var B=0;r.forEach(function(f,a){var b=f.hidden?void 0:w.getPointValue({point:f,index:a,seriesIndex:0,maxValue:!1,chartType:e,visualProperties:c,viewModel:F,currentFeatureIndex:G,chartData:z}),b=(y[a]=b)||0;f.hidden||(B++,m+=b,n+=Math.abs(b),
p=Math.min(p,b),q=Math.max(q,b))});var H=m/B;r.forEach(function(a,t){if(!a.hidden){var b=y[t],f=b||0,d;h.isConditionalStylingEnabled(e)&&c.conditionalStyling&&(d=(d=v.getConditionalStyle(f,c.conditionalStyling))&&d.backgroundColor);d=d||C.calcColorForPoint({point:a,seriesItem:g,pointIndex:t,seriesIndex:0,numSeries:x.length,chartType:e,themeSettings:E});l.data.push({originalValue:b,x:1,y:Math.max(1E-4,f),isUnavailableData:isNaN(b),valueProp:"y",unsortedIndex:t,name:a.label,point:a,fill:d,valuesSumsInSeries:n,
seriesIndex:0,tooltip:D.getTooltipInfo({yValue:b,pointLabel:a.label,seriesLabel:null,minInSeriesValue:p,maxInSeriesValue:q,sumInSeriesValue:m,absSumInSeriesValue:n,avgInSeriesValue:H,visualProperties:c,chartType:e,color:d,conditionalStyling:c.conditionalStyling,fieldInfo:a.fieldInfo,decimals:a.value&&a.value.decimals}),stroke:{width:0}})}});h.isSortingEnabled(e)&&k&&k!==u.NONE&&l.data.sort(function(a,c){return(a.y-c.y)*(k===u.DESC?-1:1)});return a}}});