// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.28/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/tooltip/GridCellTooltipBuilder","dojo/_base/declare ../GridDataUtil ../../../supportClasses/conditionalStyling/ConditionalStyleLegendBuilder ../../valueField/supportClasses/ValueFieldTextTrimmer ./_ScriptExpressionBuilder esri/dijit/geoenrichment/utils/ObjectUtil esri/dijit/geoenrichment/utils/TooltipUtil esri/dijit/geoenrichment/ReportPlayer/config dojo/i18n!esri/nls/jsapi".split(" "),function(n,f,r,t,u,v,w,p,g){g=g.geoenrichment.dijit.ReportPlayer.Grid;
var x=n(null,{_content:"",getContent:function(){return this._content?"\x3cdiv class\x3d'esriGEAdjustableGridValueField_cellTooltipContent'\x3e"+this._content+"\x3c/div\x3e":null},addValue:function(a){this._content+="\x3cdiv class\x3d'esriGERowHigh esriGEAdjustableGridValueField_cellTooltipContentValue'\x3e"+a+"\x3c/div\x3e"},addImageValue:function(a){var c=f.getNumericCellValue(a);isNaN(c)||"number"!==typeof c||(a=a.numberFormatFunction?a.numberFormatFunction(c):v.formatNumber(c),this._content+="\x3cdiv class\x3d'esriGERowHigh esriGEAdjustableGridValueField_cellTooltipContentValue'\x3e"+
a+"\x3c/div\x3e")},addAlias:function(a){this._content+="\x3cdiv class\x3d'esriGERowHigh'\x3e\x3cb\x3e"+g.variable+"\x3c/b\x3e "+a+"\x3c/div\x3e"},addExpression:function(a,c,b){if(a=u.buildTooltipExpression(a,c))this._content+="\x3cdiv class\x3d'esriGERowHigh'\x3e"+g.variableIsBasedOnExpression+"\x3c/div\x3e",this._content+="\x3cdiv class\x3d'esriGERowHigh'\x3e"+a+"\x3c/div\x3e"},addConditionalStyleLegend:function(a){var c=f.getNumericCellValue(a),b=f.getConditionalFormatting(a);a=f.getFieldInfo(a).isImage;
this._content+=r.createLegendNode(b,a?"image":"text",c).outerHTML},addTextBlock:function(a){this._content+="\x3cdiv class\x3d'esriGERowHigh'\x3e"+a+"\x3c/div\x3e"},addSeparator:function(){this._content+="\x3cdiv class\x3d'esriGERowHigh esriGEAdjustableGridValueField_cellTooltipContentSeparator'\x3e\x3c/div\x3e"}}),y=/<\w/,m={setDynamicTooltipToCell:function(a,c,b){var h=f.getFieldInfo(a);if(a.hasOverflowText()||f.isVariableFieldCell(a)||f.isImageTriggerCell(a))h=h&&(h.script||h.expressionText),a.own(w.setTooltipToNode(a.domNode,
function(){return m.renderCellTooltip(a,c,b)},{classes:"esriGEAdjustableGridValueField_cellTooltip",notRestricted:h,stayOnHover:h}))},renderCellTooltip:function(a,c,b){b=b||{};var h=b.getExpressionText||function(a){return p.modules.complexCellTooltips&&a.expressionText},g=t.getFullText(a),k=f.getConditionalFormatting(a),d=f.getFieldInfo(a),m=d&&(d.hasVariable||d.script),q=d&&d.isImage,n=d&&d.isRichText||g&&y.test(g),e=new x;!g||n||q||b.hideValue||e.addValue(g);if(m){e.addAlias(d.script?d.script.alias:
d.alias);var l=h(d);l&&e.addExpression(l,c,b.makeExpressionExpandable)}else q&&k&&k.fieldInfo&&(!b.hideValue&&e.addImageValue(a),e.addAlias(k.fieldInfo.script?k.fieldInfo.script.alias:k.fieldInfo.alias),(l=h(k.fieldInfo))&&e.addExpression(l,c,b.makeExpressionExpandable));k&&p.modules.complexCellTooltips&&(l&&e.addSeparator(),b.conditionalLegendDesc&&e.addTextBlock(b.conditionalLegendDesc),e.addConditionalStyleLegend(a));return e.getContent()}};return m});